// Purpose: List external IPs contacted by the suspicious process.
// Expected output: Public remote IPs, ports, and connection timestamps.
// Flag: 19_external_ip_contacted
let device = "ch-ops-wks02";
let startTime = datetime(2025-11-15);
let endTime = datetime(2025-12-05);
DeviceNetworkEvents
| where DeviceName == device
| where Timestamp between (startTime .. endTime)
| where RemoteIPType == "Public"
| project Timestamp, RemoteIP, RemotePort, ActionType, InitiatingProcessCommandLine
